Here's the updated batch script that processes all `.txt` files in a directory to their `.html` equivalents:

## Main Batch Processing Script (`process_reports.bat`)

```batch
@echo off
setlocal enabledelayedexpansion

echo ========================================
echo    AI REPORT BATCH PROCESSOR
echo ========================================
echo.

:: Configuration
set "SCRIPT_DIR=%~dp0"
set "INPUT_DIR=%SCRIPT_DIR%reports"
set "OUTPUT_DIR=%SCRIPT_DIR%html_reports"
set "PYTHON_SCRIPT=report_processor.py"
set "LOG_FILE=%SCRIPT_DIR%processing.log"

:: Create directories if they don't exist
if not exist "%INPUT_DIR%" (
    echo Creating input directory: %INPUT_DIR%
    mkdir "%INPUT_DIR%"
)

if not exist "%OUTPUT_DIR%" (
    echo Creating output directory: %OUTPUT_DIR%
    mkdir "%OUTPUT_DIR%"
)

:: Check if Python is installed
python --version >nul 2>&1
if errorlevel 1 (
    echo ERROR: Python is not installed or not in PATH
    echo Please install Python from https://python.org
    pause
    exit /b 1
)

:: Check if Python script exists
if not exist "%SCRIPT_DIR%%PYTHON_SCRIPT%" (
    echo ERROR: Python script not found: %PYTHON_SCRIPT%
    echo Please ensure the script is in the same directory
    pause
    exit /b 1
)

:: Initialize counters
set /a processed=0
set /a errors=0
set /a total=0

echo Starting batch processing...
echo Input: %INPUT_DIR%
echo Output: %OUTPUT_DIR%
echo.

:: Count total .txt files
for /f %%a in ('dir /b "%INPUT_DIR%\*.txt" 2^>nul ^| find /c /v ""') do set /a total=%%a

if !total! equ 0 (
    echo No .txt files found in %INPUT_DIR%
    echo Please place your report files in the 'reports' folder
    pause
    exit /b 1
)

echo Found !total! report files to process
echo.

:: Process each .txt file to .html
for %%f in ("%INPUT_DIR%\*.txt") do (
    set "filename=%%~nf"
    set "input_file=%%f"
    set "output_file=%OUTPUT_DIR%\!filename!.html"
    
    echo Processing: %%~nxf â†’ !filename!.html
    echo ----------------------------------------
    
    :: Call Python script to process the file
    python "%SCRIPT_DIR%%PYTHON_SCRIPT%" "!input_file!" "!output_file!"
    
    if !errorlevel! equ 0 (
        echo âœ“ Success: !filename!.html
        set /a processed+=1
    ) else (
        echo âœ— Failed: !filename!.txt
        set /a errors+=1
        
        :: Log error
        echo [ERROR] !date! !time! - Failed to process !filename!.txt >> "%LOG_FILE%"
    )
    echo.
)

:: Display summary
echo ========================================
echo BATCH PROCESSING COMPLETE
echo ========================================
echo Total .txt files found: !total!
echo Successfully converted: !processed!
echo Errors: !errors!
echo.

if !errors! gtr 0 (
    echo Check %LOG_FILE% for error details
) else (
    echo All files converted successfully!
)

echo.
echo Input:  %INPUT_DIR%\*.txt
echo Output: %OUTPUT_DIR%\*.html
echo.

:: Create index.html with all converted files
echo Creating index.html with all reports...
call :create_index

:: Open output directory in Explorer
set /p "open=Open output directory in Explorer? (Y/N): "
if /i "!open!"=="Y" (
    explorer "%OUTPUT_DIR%"
)

pause
exit /b 0

:create_index
set "INDEX_FILE=%OUTPUT_DIR%\index.html"

echo ^<!DOCTYPE html^> > "%INDEX_FILE%"
echo ^<html^>^<head^> >> "%INDEX_FILE%"
echo ^<title^>AI Target Detection Reports Index^</title^> >> "%INDEX_FILE%"
echo ^<style^> >> "%INDEX_FILE%"
echo body { font-family: Arial, sans-serif; margin: 40px; background: #f5f5f5; } >> "%INDEX_FILE%"
echo .container { max-width: 800px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); } >> "%INDEX_FILE%"
echo h1 { color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px; } >> "%INDEX_FILE%"
echo .report-list { list-style: none; padding: 0; } >> "%INDEX_FILE%"
echo .report-item { padding: 12px; border-bottom: 1px solid #eee; } >> "%INDEX_FILE%"
echo .report-item:hover { background: #f8f9fa; } >> "%INDEX_FILE%"
echo .report-link { text-decoration: none; color: #2980b9; font-weight: 500; } >> "%INDEX_FILE%"
echo .report-link:hover { color: #3498db; } >> "%INDEX_FILE%"
echo .count { float: right; color: #7f8c8d; } >> "%INDEX_FILE%"
echo .summary { background: #e8f5e8; padding: 15px; border-radius: 5px; margin-bottom: 20px; } >> "%INDEX_FILE%"
echo ^</style^> >> "%INDEX_FILE%"
echo ^</head^> >> "%INDEX_FILE%"
echo ^<body^> >> "%INDEX_FILE%"
echo ^<div class="container"^> >> "%INDEX_FILE%"
echo ^<h1^>ðŸ“Š AI Target Detection Reports^</h1^> >> "%INDEX_FILE%"
echo ^<div class="summary"^> >> "%INDEX_FILE%"
echo Generated on !date! at !time! >> "%INDEX_FILE%"
echo ^<br^>Total reports: !total! â€¢ Successful: !processed! â€¢ Errors: !errors! >> "%INDEX_FILE%"
echo ^</div^> >> "%INDEX_FILE%"
echo ^<ul class="report-list"^> >> "%INDEX_FILE%"

set /a count=0
for %%f in ("%OUTPUT_DIR%\*.html") do (
    if /i not "%%~nxf"=="index.html" (
        set /a count+=1
        echo ^<li class="report-item"^>^<a class="report-link" href="%%~nxf"^>^<span class="count"^>!count!^</span^>%%~nxf^</a^>^</li^> >> "%INDEX_FILE%"
    )
)

echo ^</ul^> >> "%INDEX_FILE%"
echo ^</div^> >> "%INDEX_FILE%"
echo ^</body^>^</html^> >> "%INDEX_FILE%"

echo âœ“ Index created: index.html
goto :eof
```

## Advanced Batch Processor with Monitoring (`process_reports_advanced.bat`)

```batch
@echo off
setlocal enabledelayedexpansion

title AI Report Batch Processor - Advanced Mode

:: Configuration
set "CONFIG_FILE=%~dp0batch_config.ini"
set "SCRIPT_DIR=%~dp0"
set "DEFAULT_INPUT=%SCRIPT_DIR%reports"
set "DEFAULT_OUTPUT=%SCRIPT_DIR%html_reports"
set "PYTHON_SCRIPT=report_processor.py"
set "LOG_FILE=%SCRIPT_DIR%processing.log"
set "ARCHIVE_DIR=%SCRIPT_DIR%processed_reports"

:: Load configuration
if exist "%CONFIG_FILE%" (
    for /f "tokens=1,2 delims==" %%a in (%CONFIG_FILE%) do (
        if "%%a"=="INPUT_DIR" set "INPUT_DIR=%%b"
        if "%%a"=="OUTPUT_DIR" set "OUTPUT_DIR=%%b"
        if "%%a"=="ARCHIVE_PROCESSED" set "ARCHIVE_PROCESSED=%%b"
        if "%%a"=="CREATE_INDEX" set "CREATE_INDEX=%%b"
        if "%%a"=="AUTO_MONITOR" set "AUTO_MONITOR=%%b"
    )
)

:: Set defaults if not configured
if not defined INPUT_DIR set "INPUT_DIR=%DEFAULT_INPUT%"
if not defined OUTPUT_DIR set "OUTPUT_DIR=%DEFAULT_OUTPUT%"
if not defined ARCHIVE_PROCESSED set "ARCHIVE_PROCESSED=false"
if not defined CREATE_INDEX set "CREATE_INDEX=true"
if not defined AUTO_MONITOR set "AUTO_MONITOR=false"

:menu
cls
echo ========================================
echo    AI REPORT BATCH PROCESSOR - ADVANCED
echo ========================================
echo.
echo 1. Convert All .txt to .html
echo 2. Convert Single .txt File
echo 3. Monitor Directory (Auto-convert new .txt)
echo 4. Settings and Configuration
echo 5. View Processing Log
echo 6. Create Reports Index
echo 7. Exit
echo.
set /p "choice=Select option (1-7): "

if "%choice%"=="1" goto process_all
if "%choice%"=="2" goto process_single
if "%choice%"=="3" goto monitor
if "%choice%"=="4" goto settings
if "%choice%"=="5" goto view_log
if "%choice%"=="6" goto create_index
if "%choice%"=="7" exit /b 0

echo Invalid choice. Press any key to continue...
pause >nul
goto menu

:process_all
cls
echo Converting all .txt files in %INPUT_DIR% to .html
echo.

:: Create directories
if not exist "%INPUT_DIR%" mkdir "%INPUT_DIR%"
if not exist "%OUTPUT_DIR%" mkdir "%OUTPUT_DIR%"
if not exist "%ARCHIVE_DIR%" mkdir "%ARCHIVE_DIR%"

:: Check dependencies
python --version >nul 2>&1
if errorlevel 1 (
    echo ERROR: Python not found
    pause
    goto menu
)

if not exist "%SCRIPT_DIR%%PYTHON_SCRIPT%" (
    echo ERROR: Python script not found
    pause
    goto menu
)

set /a processed=0
set /a errors=0
set /a total=0

:: Count .txt files
for /f %%a in ('dir /b "%INPUT_DIR%\*.txt" 2^>nul ^| find /c /v ""') do set /a total=%%a

if !total! equ 0 (
    echo No .txt files found in %INPUT_DIR%
    pause
    goto menu
)

echo Found !total! .txt files. Starting conversion...
echo.

for %%f in ("%INPUT_DIR%\*.txt") do (
    set "filename=%%~nf"
    set "input_file=%%f"
    set "output_file=%OUTPUT_DIR%\!filename!.html"
    
    echo [!time!] Converting: %%~nxf â†’ !filename!.html
    
    python "%SCRIPT_DIR%%PYTHON_SCRIPT%" "!input_file!" "!output_file!"
    
    if !errorlevel! equ 0 (
        echo [!time!] âœ“ Success: !filename!.html
        set /a processed+=1
        
        :: Archive original .txt if enabled
        if /i "!ARCHIVE_PROCESSED!"=="true" (
            move "!input_file!" "%ARCHIVE_DIR%\%~nxf" >nul 2>&1
            echo [!time!] Archived original: %%~nxf
        )
    ) else (
        echo [!time!] âœ— Failed: !filename!.txt
        set /a errors+=1
        echo [!date! !time!] FAILED: !filename!.txt >> "%LOG_FILE%"
    )
)

echo.
echo = CONVERSION SUMMARY =====================
echo Total .txt files: !total!
echo Successfully converted: !processed!
echo Errors: !errors!
echo Output directory: %OUTPUT_DIR%
echo.

:: Create index if enabled
if /i "!CREATE_INDEX!"=="true" (
    call :create_index
)

echo Press any key to continue...
pause >nul
goto menu

:process_single
cls
echo Available .txt files:
echo.
dir /b "%INPUT_DIR%\*.txt" 2>nul
echo.
set /p "filename=Enter filename (without .txt): "

if not exist "%INPUT_DIR%\%filename%.txt" (
    echo File not found: %filename%.txt
    pause
    goto menu
)

echo Converting %filename%.txt to %filename%.html...
python "%SCRIPT_DIR%%PYTHON_SCRIPT%" "%INPUT_DIR%\%filename%.txt" "%OUTPUT_DIR%\%filename%.html"

if !errorlevel! equ 0 (
    echo âœ“ Successfully converted: %filename%.html
    if /i "!ARCHIVE_PROCESSED!"=="true" (
        move "%INPUT_DIR%\%filename%.txt" "%ARCHIVE_DIR%\%filename%.txt" >nul 2>&1
        echo Original file archived
    )
) else (
    echo âœ— Failed to convert %filename%.txt
)

pause
goto menu

:monitor
cls
echo Directory Monitoring Mode - Auto-convert new .txt files
echo.
echo Watching: %INPUT_DIR%
echo Output: %OUTPUT_DIR%
echo Press Ctrl+C to stop monitoring...
echo.

:monitor_loop
for %%f in ("%INPUT_DIR%\*.txt") do (
    set "filename=%%~nf"
    if not exist "%OUTPUT_DIR%\!filename!.html" (
        echo [!time!] New .txt detected: %%~nxf
        python "%SCRIPT_DIR%%PYTHON_SCRIPT%" "%%f" "%OUTPUT_DIR%\!filename!.html"
        if !errorlevel! equ 0 (
            echo [!time!] âœ“ Auto-converted: !filename!.html
            if /i "!ARCHIVE_PROCESSED!"=="true" (
                move "%%f" "%ARCHIVE_DIR%\%%~nxf" >nul 2>&1
                echo [!time!] Archived original
            )
        ) else (
            echo [!time!] âœ— Auto-convert failed: !filename!.txt
        )
        echo.
    )
)

:: Wait 5 seconds before checking again
timeout /t 5 /nobreak >nul
goto monitor_loop

:settings
cls
echo = CONFIGURATION ===========================
echo.
echo Current settings:
echo 1. Input Directory: %INPUT_DIR%
echo 2. Output Directory: %OUTPUT_DIR%
echo 3. Archive Original .txt Files: %ARCHIVE_PROCESSED%
echo 4. Create Index Page: %CREATE_INDEX%
echo 5. Auto-monitor Directory: %AUTO_MONITOR%
echo.
echo 6. Back to Menu
echo.
set /p "setting=Select setting to change (1-6): "

if "%setting%"=="1" (
    set /p "NEW_INPUT=Enter new input directory: "
    set "INPUT_DIR=!NEW_INPUT!"
)
if "%setting%"=="2" (
    set /p "NEW_OUTPUT=Enter new output directory: "
    set "OUTPUT_DIR=!NEW_OUTPUT!"
)
if "%setting%"=="3" (
    if /i "!ARCHIVE_PROCESSED!"=="true" (
        set "ARCHIVE_PROCESSED=false"
    ) else (
        set "ARCHIVE_PROCESSED=true"
    )
)
if "%setting%"=="4" (
    if /i "!CREATE_INDEX!"=="true" (
        set "CREATE_INDEX=false"
    ) else (
        set "CREATE_INDEX=true"
    )
)
if "%setting%"=="5" (
    if /i "!AUTO_MONITOR!"=="true" (
        set "AUTO_MONITOR=false"
    ) else (
        set "AUTO_MONITOR=true"
    )
)

:: Save configuration
echo INPUT_DIR=%INPUT_DIR% > "%CONFIG_FILE%"
echo OUTPUT_DIR=%OUTPUT_DIR% >> "%CONFIG_FILE%"
echo ARCHIVE_PROCESSED=%ARCHIVE_PROCESSED% >> "%CONFIG_FILE%"
echo CREATE_INDEX=%CREATE_INDEX% >> "%CONFIG_FILE%"
echo AUTO_MONITOR=%AUTO_MONITOR% >> "%CONFIG_FILE%"

goto menu

:view_log
cls
if exist "%LOG_FILE%" (
    echo Processing Log:
    echo ===============
    type "%LOG_FILE%"
) else (
    echo No log file found.
)
echo.
pause
goto menu

:create_index
echo Creating index page with all .html reports...
set "INDEX_FILE=%OUTPUT_DIR%\index.html"

echo ^<!DOCTYPE html^> > "%INDEX_FILE%"
echo ^<html^>^<head^>^<title^>AI Reports Index^</title^> >> "%INDEX_FILE%"
echo ^<style^> >> "%INDEX_FILE%"
echo body { font-family: Arial, sans-serif; margin: 40px; background: #f5f5f5; } >> "%INDEX_FILE%"
echo .container { max-width: 800px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); } >> "%INDEX_FILE%"
echo h1 { color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px; } >> "%INDEX_FILE%"
echo .report-item { padding: 10px; border-bottom: 1px solid #eee; } >> "%INDEX_FILE%"
echo .report-link { text-decoration: none; color: #2980b9; font-weight: 500; } >> "%INDEX_FILE%"
echo .report-link:hover { color: #3498db; } >> "%INDEX_FILE%"
echo ^</style^>^</head^>^<body^> >> "%INDEX_FILE%"
echo ^<div class="container"^> >> "%INDEX_FILE%"
echo ^<h1^>AI Target Detection Reports^</h1^> >> "%INDEX_FILE%"
echo ^<p^>Generated on !date! !time%^</p^> >> "%INDEX_FILE%"

set /a count=0
for %%f in ("%OUTPUT_DIR%\*.html") do (
    if /i not "%%~nxf"=="index.html" (
        set /a count+=1
        echo ^<div class="report-item"^>^<a class="report-link" href="%%~nxf"^>%%~nxf^</a^>^</div^> >> "%INDEX_FILE%"
    )
)

echo ^</div^>^</body^>^</html^> >> "%INDEX_FILE%"
echo Index created: %INDEX_FILE%
pause
goto menu
```

## Configuration File (`batch_config.ini`)

```ini
INPUT_DIR=reports
OUTPUT_DIR=html_reports
ARCHIVE_PROCESSED=false
CREATE_INDEX=true
AUTO_MONITOR=false
```

## Quick Convert Script (`quick_convert.bat`)

```batch
@echo off
setlocal enabledelayedexpansion

echo Quick Convert - All .txt to .html
echo.

set "INPUT_DIR=reports"
set "OUTPUT_DIR=html_reports"

if not exist "%INPUT_DIR%" (
    echo Creating %INPUT_DIR%...
    mkdir "%INPUT_DIR%"
)

if not exist "%OUTPUT_DIR%" (
    echo Creating %OUTPUT_DIR%...
    mkdir "%OUTPUT_DIR%"
)

set /a count=0
for %%f in ("%INPUT_DIR%\*.txt") do (
    set "filename=%%~nf"
    echo Converting: %%~nxf
    python report_processor.py "%%f" "%OUTPUT_DIR%\!filename!.html"
    if !errorlevel! equ 0 (
        echo âœ“ !filename!.html
        set /a count+=1
    ) else (
        echo âœ— Failed: %%~nxf
    )
)

echo.
echo Conversion complete: !count! files processed
echo Output: %OUTPUT_DIR%
pause
```

## Usage:

1. **Place all files in same directory:**
   - `report_processor.py` (the fixed Python script)
   - `process_reports.bat` (main batch processor)
   - `process_reports_advanced.bat` (advanced version)
   - `quick_convert.bat` (simple one-time conversion)

2. **Create folder structure:**
   ```
   your_directory/
   â”œâ”€â”€ report_processor.py
   â”œâ”€â”€ process_reports.bat
   â”œâ”€â”€ process_reports_advanced.bat
   â”œâ”€â”€ quick_convert.bat
   â”œâ”€â”€ reports/           (put your .txt files here)
   â””â”€â”€ html_reports/      (html files will be created here)
   ```

3. **Run:**
   - `quick_convert.bat` - Fast one-time conversion
   - `process_reports.bat` - Full batch processing with index
   - `process_reports_advanced.bat` - Menu-driven advanced features

The batch scripts will automatically convert every `.txt` file in the `reports` folder to its corresponding `.html` file in the `html_reports` folder, maintaining the original filenames.

---

Ah, you're right! Here's the updated Python script that handles batch processing of all `.txt` files in a directory:

## Batch Processing Python Script (`report_processor.py`)

```python
import re
from pathlib import Path
import sys
import os

def process_single_file(txt_file_path, output_html_path):
    """Process a single .txt file to .html"""
    try:
        print(f"Processing: {txt_file_path}")
        
        with open(txt_file_path, 'r', encoding='utf-8') as f:
            content = f.read()
        
        # More flexible section splitting
        sections = re.split(r'SECTION-I\s*:|Section-II\s*:|SECTION-II\s*:', content, flags=re.IGNORECASE)
        
        if len(sections) < 3:
            # Try alternative splitting method
            return parse_report_alternative(content, output_html_path, txt_file_path)
        
        # Extract header and sections
        header = sections[0].strip()
        section1 = sections[1].strip()
        section2 = sections[2].strip()
        
        section1_data = parse_section1(section1)
        total_targets, table_data, time_taken = parse_section2(section2)
        
        html_output = generate_html(header, section1_data, total_targets, table_data, time_taken)
        
        with open(output_html_path, 'w', encoding='utf-8') as f:
            f.write(html_output)
        
        print(f"âœ“ Successfully created: {output_html_path}")
        return True
        
    except Exception as e:
        print(f"âŒ Error processing {txt_file_path}: {str(e)}")
        # Create error HTML
        error_html = f"""
        <!DOCTYPE html>
        <html>
        <head>
            <title>Processing Error</title>
            <style>
                body {{ font-family: Arial, sans-serif; padding: 20px; color: #d63031; }}
                .error {{ background: #ffeaa7; padding: 20px; border-radius: 5px; }}
            </style>
        </head>
        <body>
            <div class="error">
                <h2>Error Processing Report</h2>
                <p><strong>File:</strong> {Path(txt_file_path).name}</p>
                <p><strong>Error:</strong> {str(e)}</p>
            </div>
        </body>
        </html>
        """
        with open(output_html_path, 'w', encoding='utf-8') as f:
            f.write(error_html)
        return False

def process_batch(input_dir, output_dir):
    """Process all .txt files in a directory to .html"""
    input_path = Path(input_dir)
    output_path = Path(output_dir)
    
    # Create output directory if it doesn't exist
    output_path.mkdir(exist_ok=True)
    
    # Find all .txt files
    txt_files = list(input_path.glob("*.txt"))
    
    if not txt_files:
        print(f"âŒ No .txt files found in {input_dir}")
        return 0, 0
    
    print(f"Found {len(txt_files)} .txt files to process")
    print("=" * 50)
    
    success_count = 0
    error_count = 0
    
    for txt_file in txt_files:
        # Create corresponding .html filename
        html_file = output_path / f"{txt_file.stem}.html"
        
        success = process_single_file(txt_file, html_file)
        
        if success:
            success_count += 1
        else:
            error_count += 1
    
    print("=" * 50)
    print(f"ðŸŽ‰ BATCH PROCESSING COMPLETE")
    print(f"âœ… Successful: {success_count}")
    print(f"âŒ Errors: {error_count}")
    print(f"ðŸ“ Output directory: {output_dir}")
    
    return success_count, error_count

def parse_report_alternative(content, output_html_path, txt_file_path):
    """Alternative parsing method for different report formats"""
    try:
        # Extract header (everything before SECTION-I)
        header_match = re.search(r'^(.+?)(?=SECTION-I)', content, re.DOTALL | re.IGNORECASE)
        header = header_match.group(1).strip() if header_match else "OUTPUT OF AI-BASED TARGET DETECTION"
        
        # Extract Section I
        section1_match = re.search(r'SECTION-I\s*:(.+?)(?=Section-II|SECTION-II)', content, re.DOTALL | re.IGNORECASE)
        if not section1_match:
            section1_match = re.search(r'SECTION-I\s*:(.+?)(?=Total number|TARGET CATEGORY)', content, re.DOTALL | re.IGNORECASE)
        
        section1 = section1_match.group(1).strip() if section1_match else ""
        
        # Extract Section II
        section2_match = re.search(r'Section-II\s*:(.+?)(?=Time taken for)', content, re.DOTALL | re.IGNORECASE)
        if not section2_match:
            section2_match = re.search(r'SECTION-II\s*:(.+?)(?=Time taken for)', content, re.DOTALL | re.IGNORECASE)
        if not section2_match:
            # If we can't find the end, take everything after Section-II
            section2_match = re.search(r'Section-II\s*:(.+)', content, re.DOTALL | re.IGNORECASE)
        
        section2 = section2_match.group(1).strip() if section2_match else ""
        
        section1_data = parse_section1(section1)
        total_targets, table_data, time_taken = parse_section2(section2)
        
        html_output = generate_html(header, section1_data, total_targets, table_data, time_taken)
        
        with open(output_html_path, 'w', encoding='utf-8') as f:
            f.write(html_output)
        
        print(f"âœ“ Alternative method succeeded: {output_html_path}")
        return True
        
    except Exception as e:
        print(f"âŒ Alternative parsing also failed for {txt_file_path}: {str(e)}")
        return False

def parse_section1(section1_content):
    """Parse Section I with key-value pairs"""
    section1_data = []
    
    if not section1_content:
        return section1_data
        
    lines = section1_content.split('\n')
    
    for line in lines:
        line = line.strip()
        if not line:
            continue
            
        if ':' in line:
            key, value = line.split(':', 1)
            key = key.strip()
            value = value.strip()
            if key and value:
                section1_data.append({'key': key, 'value': value})
    
    return section1_data

def parse_section2(section2_content):
    """Parse Section II with dynamic target categories and entries"""
    total_targets = 0
    table_data = []
    time_taken = ""
    
    if not section2_content:
        return total_targets, table_data, time_taken
    
    # Find total targets - handle no space after section header
    total_match = re.search(r'Total number of targets detected in this image are\s*(\d+)', section2_content)
    if total_match:
        total_targets = int(total_match.group(1))
    
    # Find time taken
    time_match = re.search(r'Time taken for.*?\(hrs:min:sec\)', section2_content)
    if time_match:
        time_taken = time_match.group(0)
    
    # Parse the target table
    lines = section2_content.split('\n')
    current_category = None
    in_table_section = False
    
    for line in lines:
        line = line.rstrip()
        
        # Skip empty lines
        if not line.strip():
            continue
            
        # Look for table header
        if 'TARGET CATEGORY' in line and 'TARGET NAME' in line and 'TARGET COUNT' in line:
            in_table_section = True
            continue
            
        # Stop if we hit time taken
        if 'Time taken for' in line:
            break
            
        if in_table_section:
            # Check for category lines (text ending with colon)
            if re.search(r'[A-Za-z][A-Za-z\s]+:$', line.strip()):
                current_category = line.strip()[:-1]  # Remove trailing colon
            elif current_category and line.strip():
                # This is a target entry
                target_entry = parse_target_line(line)
                if target_entry:
                    table_data.append({
                        'category': current_category,
                        'name': target_entry['name'],
                        'count': target_entry['count']
                    })
    
    return total_targets, table_data, time_taken

def parse_target_line(line):
    """Parse individual target lines with flexible formatting"""
    line = line.strip()
    
    # Remove any leading colons or spaces
    line = re.sub(r'^\s*:\s*', '', line)
    
    # Handle the specific format from the example
    if re.match(r'^[A-Za-z\-]+\s+[A-Za-z0-9\-]+$', line):
        parts = line.split()
        if len(parts) >= 2:
            return {'name': parts[0], 'count': parts[1]}
    
    # Split by multiple spaces
    parts = re.split(r'\s{2,}', line)
    
    if len(parts) >= 2:
        name = parts[0].strip()
        count = parts[1].strip()
    elif len(parts) == 1:
        name = parts[0].strip()
        count = '1'  # Default count
    else:
        return None
        
    # Validate count is numeric
    if not re.match(r'^\d+$', count):
        count = '1'
    
    return {'name': name, 'count': count}

def generate_html(header, section1_data, total_targets, table_data, time_taken):
    # Build section 1 HTML
    section1_html = ""
    for item in section1_data:
        section1_html += f"""
        <div class="info-row">
            <div class="info-key">{item['key']}</div>
            <div class="info-separator">:</div>
            <div class="info-value">{item['value']}</div>
        </div>"""
    
    # If no section1 data, create placeholder
    if not section1_html:
        section1_html = """
        <div class="info-row">
            <div class="info-key">No image information available</div>
        </div>"""
    
    # Build table HTML
    table_html = ""
    if table_data:
        table_rows = ""
        for item in table_data:
            table_rows += f"""
            <tr>
                <td class="category-cell">{item['category']}</td>
                <td class="name-cell">{item['name']}</td>
                <td class="count-cell">{item['count']}</td>
            </tr>"""
        
        table_html = f"""
        <table class="modern-table">
            <thead>
                <tr>
                    <th>TARGET CATEGORY</th>
                    <th>TARGET NAME</th>
                    <th>TARGET COUNT</th>
                </tr>
            </thead>
            <tbody>
                {table_rows}
            </tbody>
        </table>"""
    else:
        table_html = """
        <div class="empty-table">
            <p>No target data available or unable to parse target information</p>
            <p>Please check the original report format</p>
        </div>"""
    
    return f"""<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Target Detection Report</title>
    <style>
        * {{
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }}
        
        body {{
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f8f9fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }}
        
        .report-container {{
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }}
        
        .report-header {{
            background: #2c3e50;
            color: white;
            padding: 25px;
            text-align: center;
            border-bottom: 3px solid #3498db;
        }}
        
        .report-header h1 {{
            font-size: 1.4em;
            font-weight: 400;
            font-family: 'Courier New', monospace;
            white-space: pre;
            margin: 0;
        }}
        
        .section {{
            padding: 25px;
            border-bottom: 1px solid #e9ecef;
        }}
        
        .section:last-child {{
            border-bottom: none;
        }}
        
        .section-title {{
            color: #2c3e50;
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 20px;
            padding-bottom: 8px;
            border-bottom: 2px solid #3498db;
        }}
        
        .info-container {{
            font-family: 'Courier New', monospace;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
        }}
        
        .info-row {{
            display: table-row;
            margin-bottom: 5px;
        }}
        
        .info-key {{
            display: table-cell;
            font-weight: 600;
            color: #495057;
            padding: 4px 8px 4px 0;
            white-space: pre;
            min-width: 220px;
        }}
        
        .info-separator {{
            display: table-cell;
            padding: 4px 5px 4px 0;
            color: #6c757d;
        }}
        
        .info-value {{
            display: table-cell;
            color: #212529;
            white-space: pre;
            padding: 4px 0;
        }}
        
        .total-targets {{
            background: #e8f5e8;
            border: 1px solid #28a745;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 20px;
            color: #155724;
            font-weight: 500;
            font-size: 1.1em;
        }}
        
        .table-container {{
            overflow-x: auto;
            border-radius: 6px;
            border: 1px solid #dee2e6;
            margin-top: 15px;
        }}
        
        .modern-table {{
            width: 100%;
            border-collapse: collapse;
            font-size: 0.95em;
            min-width: 600px;
        }}
        
        .modern-table thead {{
            background: #343a40;
            color: white;
        }}
        
        .modern-table th {{
            padding: 15px 12px;
            text-align: left;
            font-weight: 500;
            border: none;
        }}
        
        .modern-table td {{
            padding: 12px;
            border-bottom: 1px solid #dee2e6;
        }}
        
        .modern-table tbody tr:hover {{
            background: #f8f9fa;
        }}
        
        .category-cell {{
            font-weight: 600;
            color: #e74c3c;
            font-family: 'Courier New', monospace;
            white-space: pre;
        }}
        
        .name-cell {{
            color: #2980b9;
            font-family: 'Courier New', monospace;
            white-space: pre;
        }}
        
        .count-cell {{
            text-align: center;
            font-weight: 600;
            color: #f39c12;
            font-family: 'Courier New', monospace;
        }}
        
        .empty-table {{
            text-align: center;
            padding: 40px;
            color: #6c757d;
            font-style: italic;
            background: #f8f9fa;
        }}
        
        .report-footer {{
            background: #e9ecef;
            padding: 15px 25px;
            text-align: center;
            color: #495057;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }}
        
        @media (max-width: 768px) {{
            body {{
                padding: 10px;
            }}
            
            .section {{
                padding: 20px;
            }}
            
            .report-header {{
                padding: 20px;
            }}
            
            .report-header h1 {{
                font-size: 1.1em;
                white-space: pre-wrap;
            }}
            
            .info-key {{
                min-width: 150px;
            }}
            
            .modern-table {{
                font-size: 0.85em;
            }}
            
            .modern-table th,
            .modern-table td {{
                padding: 8px 10px;
            }}
        }}
    </style>
</head>
<body>
    <div class="report-container">
        <div class="report-header">
            <h1>{header}</h1>
        </div>
        
        <div class="section">
            <h2 class="section-title">SECTION-I: IMAGE INFO</h2>
            <div class="info-container">
                {section1_html}
            </div>
        </div>
        
        <div class="section">
            <h2 class="section-title">SECTION-II: TARGET DETECTIONS</h2>
            
            <div class="total-targets">
                Total number of targets detected in this image are {total_targets}
            </div>
            
            <div class="table-container">
                {table_html}
            </div>
        </div>
        
        <div class="report-footer">
            {time_taken if time_taken else "Time information not available"}
        </div>
    </div>
</body>
</html>"""

if __name__ == "__main__":
    if len(sys.argv) == 3:
        # Single file mode: python report_processor.py input.txt output.html
        input_file = sys.argv[1]
        output_file = sys.argv[2]
        
        if not Path(input_file).exists():
            print(f"âŒ Input file not found: {input_file}")
            sys.exit(1)
            
        success = process_single_file(input_file, output_file)
        sys.exit(0 if success else 1)
        
    elif len(sys.argv) == 2 and sys.argv[1] == "batch":
        # Batch mode: python report_processor.py batch
        input_dir = "reports"
        output_dir = "html_reports"
        success_count, error_count = process_batch(input_dir, output_dir)
        sys.exit(0 if error_count == 0 else 1)
        
    elif len(sys.argv) == 3 and sys.argv[1] == "batch":
        # Batch mode with custom directories: python report_processor.py batch input_dir output_dir
        input_dir = sys.argv[2]
        output_dir = sys.argv[3] if len(sys.argv) > 3 else "html_reports"
        success_count, error_count = process_batch(input_dir, output_dir)
        sys.exit(0 if error_count == 0 else 1)
        
    else:
        print("Usage:")
        print("  Single file: python report_processor.py <input.txt> <output.html>")
        print("  Batch mode:  python report_processor.py batch")
        print("  Batch with custom dirs: python report_processor.py batch <input_dir> <output_dir>")
        print()
        print("Examples:")
        print("  python report_processor.py report.txt report.html")
        print("  python report_processor.py batch")
        print("  python report_processor.py batch ./reports ./html_reports")
        sys.exit(1)
```

## Simple Batch Script to Call the Python Batch Mode (`run_batch.bat`)

```batch
@echo off
echo Starting batch conversion of all .txt files...
echo.

python report_processor.py batch

echo.
pause
```

## Usage:

Now you have multiple ways to run batch processing:

### Method 1: Python Batch Mode
```bash
# Process all .txt files in ./reports to ./html_reports
python report_processor.py batch

# Process all .txt files in custom directories
python report_processor.py batch ./input_reports ./output_html
```

### Method 2: Single File Mode (existing)
```bash
# Process single file
python report_processor.py report.txt report.html
```

### Method 3: Windows Batch File
```bash
# Just double-click:
run_batch.bat
```

## Folder Structure:
```
your_directory/
â”œâ”€â”€ report_processor.py     (the updated Python script)
â”œâ”€â”€ run_batch.bat          (simple batch runner)
â”œâ”€â”€ reports/               (put your .txt files here)
â”‚   â”œâ”€â”€ report1.txt
â”‚   â”œâ”€â”€ report2.txt
â”‚   â””â”€â”€ ...
â””â”€â”€ html_reports/          (html files will be created here)
    â”œâ”€â”€ report1.html
    â”œâ”€â”€ report2.html
    â””â”€â”€ ...
```

The Python script now handles batch processing natively! Just run `python report_processor.py batch` and it will convert all `.txt` files in the `reports` folder to `.html` files in the `html_reports` folder.

---
